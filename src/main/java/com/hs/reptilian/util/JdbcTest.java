package com.hs.reptilian.util;

import com.hs.reptilian.constant.SystemConstant;

import java.sql.*;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import org.jsoup.Connection.Response;
import org.jsoup.Jsoup;

@SuppressWarnings("all")
public class JdbcTest { //定义一个类

    private static List<Account> accounts = new ArrayList<>();

    public static void main(String[] args) throws Exception { //主方法
        try {
            String driver = "com.mysql.jdbc.Driver";              //1.定义驱动程序名为driver内容为com.mysql.jdbc.Driver
            String url = "jdbc:mysql://118.24.153.209:3306/fx"; //防止乱码；useUnicode=true表示使用Unicode字符集；characterEncoding=UTF8表示使用UTF-8来编辑的。
            String user = "root";                                   //3.定义用户名，写你想要连接到的用户。
            String pass = "admin";                                  //4.用户密码。
            String querySql = "select phone, password from fx_order_account";          //5.你想要查找的表名。
            Class.forName(driver);                              //6.注册驱动程序，用java.lang包下面的class类里面的Class.froName();方法 此处的driver就是1里面定义的driver，也可以  Class.forName("com.mysql.jdbc.Driver");
            Connection conn = DriverManager.getConnection(url, user, pass);//7.获取数据库连接,使用java.sql里面的DriverManager的getConnectin(String url , String username ,String password )来完成
            Statement stmt = conn.createStatement();   //8.构造一个statement对象来执行sql语句：主要有Statement，PreparedStatement，CallableStatement三种实例来实现
            ResultSet rs = stmt.executeQuery(querySql);//9.执行sql并返还结束 ；ResultSet executeQuery(String sqlString)：用于返还一个结果集（ResultSet）对象。
            while (rs.next()) {
               // accounts.add(new Account(rs.getString("phone"), rs.getString("password")));
            }

            String s = "" +

                    "18925463832----hao112233----米嘉怡----140109200207264223\n" +
                    "18925448270----hao112233----王一同----14102420001110012X\n" +
                    "18922541121----hao112233----韩磊----420322200101305110\n" +
                    "18925477052----hao112233----赵娜----130106199210130326\n" +
                    "18924354669----hao112233----姜帆----654221200204034821\n" +
                    "18925461114----hao112233----侯俊红----371526199506011628\n" +
                    "18922949526----hao112233----杨慧----341281200209271042\n" +
                    "18928254875----hao112233----冷静----22018320000720182X\n" +
                    "18925486692----hao112233----乔欣旭----210381200103214627\n" +
                    "18929406192----hao112233----吴英慧----460026200210210109\n" +
                    "18924344332----hao112233----董芸池----220524200101080042\n" +
                    "18922540796----hao112233----陈恩慧----411723200306306122\n" +
                    "18929119942----hao112233----杨骐畅----640321200006290314\n" +
                    "18922509649----hao112233----杨海清----532924200107081536\n" +
                    "18925542452----hao112233----吴忠华----220183199010077043\n" +
                    "18922534352----hao112233----黄舒坪----433125200212200525\n" +
                    "18938188431----hao112233----农舒新----53262720021008413X\n" +
                    "18926858940----hao112233----于梦妍----371725200303259121\n" +
                    "18925801410----hao112233----于竹月----652829200204210727\n" +
                    "18929410949----hao112233----樊晓良----411324200101010517\n" +
                    "18929274446----hao112233----张智杰----411282200201235519\n" +
                    "18928254716----hao112233----王瑞霞----131122199210041666\n" +
                    "18925564190----hao112233----笙金冬----21088220001123451X\n" +
                    "18929134206----hao112233----刘俊利----513921200001013285\n" +
                    "18925754970----hao112233----张滨----340123200012234870\n" +
                    "18925788047----hao112233----林欣----513701200205153929\n" +
                    "18929265483----hao112233----杨芳----620522199208022340\n" +
                    "18938164372----hao112233----孙铭----371327200111260954\n" +
                    "18938239146----hao112233----李巧玲----421123198504192022\n" +
                    "18929254396----hao112233----王瑞----220181200112313820\n" +
                    "18922986346----hao112233----刘菊玲----450331199009171224\n" +
                    "18925594149----hao112233----陈林----612426200110293017\n" +
                    "18926801246----hao112233----王赛君----411424200002242457\n" +
                    "18922947832----hao112233----刘菊玲----450331199009171224\n" +
                    "18938254845----hao112233----鲁锡坤----411626200106214518\n" +
                    "18924342263----hao112233----谭力源----412727199802163133\n" +
                    "18929254640----hao112233----于强----220802200108063315\n" +
                    "18926842031----hao112233----林星雨----130623200004182423\n" +
                    "18929224610----hao112233----何福蛟----500239200201171537\n" +
                    "18929241352----hao112233----王雅霖----332526200306078720\n" +
                    "18925741920----hao112233----付立华----371526198712043722\n" +
                    "18925471059----hao112233----江莉莉----310107199106275728\n" +
                    "18938188946----hao112233----刘丹晨----411628200205263465\n" +
                    "18925471370----hao112233----李文艳----41070420020118152X\n" +
                    "18929246170----hao112233----侯坡----320324200002256519\n" +
                    "18929233442----hao112233----乔娜----341622200110184127\n" +
                    "18944796059----hao112233----康琴----320621199002121827\n" +
                    "18929280949----hao112233----王福霞----410184198610244420\n" +
                    "18128594187----hao112233----岳芳----410782198606231942\n" +
                    "18128594751----hao112233----梁一豪----610424200010123614\n" +
                    "18128578230----hao112233----尚梓涵----410104200005090150\n" +
                    "18128561673----hao112233----刘亚斌----410923199811236051\n" +
                    "18188837871----hao112233----车浩瀚----140525199606011932\n" +
                    "18163450919----hao112233----刘恒----410183199608247014\n" +
                    "17329507142----hao112233----毛瑞庆----210281199010016110\n" +
                    "17368237064----hao112233----原兵----210621197209271078\n" +
                    "18127146943----hao112233----黄丹丹----510623198506220427\n" +
                    "17368242849----hao112233----张林----371121200202031218\n" +
                    "18127130742----hao112233----刘卓艳----141024200201020040\n" +
                    "18925489953----hao112233----吕小磊----211381199906054124\n" +
                    "18925441691----hao112233----董江涛----140429200006248456\n" +
                    "18925474376----hao112233----柴铭涛----142703199908073738\n" +
                    "18925879147----hao112233----窦雪----220382199503043524\n" +
                    "18925764973----hao112233----曹栖源----341221200105063795\n" +
                    "18902647662----hao112233----张连----511522199112154328\n" +
                    "18925741270----hao112233----夏金红----610426197912223022\n" +
                    "18925840219----hao112233----孟晶晶----320305198308071542\n" +
                    "18924379736----hao112233----罗维----522121199703060467\n" +
                    "18922945153----hao112233----曹旋----320381200206099428\n" +
                    "18925402356----hao112233----丁星星----410327198807066430\n" +
                    "18929208472----hao112233----勇旻骞----610481200210310518\n" +
                    "18924344387----hao112233----宋海燕----371202198412096147\n" +
                    "18929204969----hao112233----何宁----411426200008111813\n" +
                    "18922914405----hao112233----苏阳----372924200103212121\n" +
                    "18929405849----hao112233----刘梦缘----130731200003072025\n" +
                    "18929216407----hao112233----韩龙飞----411202200002220515\n" +
                    "18929418945----hao112233----李婷----430381199904080046\n" +
                    "18924335347----hao112233----马然----370481200109093221\n" +
                    "18924368627----hao112233----陈豪----412326200108234234\n" +
                    "18929124994----hao112233----王庆凯----410225199908264117\n" +
                    "18925433237----hao112233----韦萌岚----450222198907043420\n" +
                    "18929206479----hao112233----魏玉婷----410305200107016522\n" +
                    "18928257475----hao112233----岳姣姣----410927199003074141\n" +
                    "18938214941----hao112233----董志薇----371526199912262027\n" +
                    "18925547612----hao112233----马兰----130921200110263220\n" +
                    "18928224735----hao112233----成千乐----622201199909206015\n" +
                    "18938224356----hao112233----秦梦瑶----142726199903062129\n" +
                    "18934148303----hao112233----孙春颖----152324199201247521\n" +
                    "18929412367----hao112233----姜佳欣----130403199808061828\n" +
                    "18926839541----hao112233----刘奥新----130525200107180727\n" +
                    "18929254137----hao112233----任记妮----412727199911125427\n" +
                    "18925436492----hao112233----庞文豪----14020320011125321X\n" +
                    "18926846795----hao112233----冉英杰----410402200002115571\n" +
                    "18926811049----hao112233----白岩浩----370911200211045611\n" +
                    "18928264334----hao112233----吕昌平----610728200109121426\n" +
                    "18934157474----hao112233----肖千----421124200108176027\n" +
                    "18924340772----hao112233----杨国丽----130107197907251520\n" +
                    "18929106147----hao112233----刘文达----371425199910242071\n" +
                    "18929247235----hao112233----王飒----411381199210262221\n" +
                    "18938188774----hao112233----郑云芳----410521199405086022\n" +
                    "18929196946----hao112233----周宇璞----410184199403273813\n" +
                    "18929245217----hao112233----杨涵琳----410881200107140797\n" +
                    "18929140074----hao112233----刘佳----14220119910601746X\n" +
                    "18926861943----hao112233----朱香----520202200208148226\n" +
                    "18925752459----hao112233----王继梦----612525199607285331\n" +
                    "18925743091----hao112233----许泽良----610102200012093514\n" +
                    "18163451767----hao112233----王晨晨----61250119990217748X\n" +
                    "18128596995----hao112233----孙克----410426198808016573\n" +
                    "18128591337----hao112233----梁一豪----610424200010123614\n" +
                    "18128556503----hao112233----赵冬冬----41018319910228706X\n" +
                    "18163450870----hao112233----李飞驰----410329199710156517\n" +
                    "18128573267----hao112233----董星星----410922199804156284\n" +
                    "17329507342----hao112233----张建芬----140430199809291626\n" +
                    "17329509304----hao112233----孙海燕----62010319811008402X\n" +
                    "18127139412----hao112233----张莹----220182199406251320\n" +
                    "19928247441----hao112233----周央芬----350681199405025727\n" +
                    "17368240947----hao112233----古五秀----362121196806170067\n" +
                    "17329519346----hao112233----卢丹----360982199006290421\n" +
                    "17322600913----hao112233----党孟宇----372901200104071629\n" +
                    "18924353846----hao112233----赵祥云----410803200105210027\n" +
                    "18925464131----hao112233----蔡础苗----460200195710043128\n" +
                    "18929200441----hao112233----刘忠鑫----513902199809031756\n" +
                    "18922964421----hao112233----邓骁驰----142303200204200026\n" +
                    "18922543569----hao112233----刘晨----130603199702231818\n" +
                    "18926843034----hao112233----辛奉佳----371426200102032027\n" +
                    "18925419940----hao112233----蒲琳----511781200202213367\n" +
                    "18925451290----hao112233----刘金朋----131025200201110032\n" +
                    "18926860492----hao112233----王紫茹----320323200204053422\n" +
                    "18922941042----hao112233----崔晓阳----372323200003130015\n" +
                    "18926864751----hao112233----周洁----150121200111228320\n" +
                    "18924370443----hao112233----殷小雪----371102200103283824\n" +
                    "18926805412----hao112233----殷小雪----371102200103283824\n" +
                    "18925884121----hao112233----杨涛----220822199110024673\n" +
                    "18925496254----hao112233----林超----445121200101184516\n" +
                    "18924344627----hao112233----支瑞欣----130521200309070520\n" +
                    "18928291045----hao112233----薛孟宇----412702199810053623\n" +
                    "18925744513----hao112233----毕亚楠----130107200204081523\n" +
                    "18922975474----hao112233----王语实----220323200101110443\n" +
                    "18924343052----hao112233----何勇----510522199505024419\n" +
                    "18925798485----hao112233----杨静----14102420020111002X\n" +
                    "18929264363----hao112233----曹媛婧----141031199901270065\n" +
                    "18929182224----hao112233----范江琳----530428199009120344\n" +
                    "18934148664----hao112233----岑金婷----450881199810115149\n" +
                    "18925541920----hao112233----孙郑伟----37132719841002154X\n" +
                    "18925745801----hao112233----赵铁超----232302199512273219\n" +
                    "18925834720----hao112233----王珏----371328199405300043\n" +
                    "18944734793----hao112233----覃业勤----452124199307251828\n" +
                    "18925460079----hao112233----吴飞飞----371421198802040026\n" +
                    "18928206746----hao112233----徐婷婷----34122619960915294X\n" +
                    "18925462857----hao112233----徐文勇----532523199602160617\n" +
                    "18925714113----hao112233----陈奕杰----511502200206100654\n" +
                    "18925805497----hao112233----李培良----612326199809203918\n" +
                    "18929182410----hao112233----李思琦----232302200203245025\n" +
                    "18925817415----hao112233----李柄岐----610203200011254613\n" +
                    "18925809142----hao112233----侯海涛----610424200104292873\n" +
                    "18925417059----hao112233----韦萌岚----450222198907043420\n" +
                    "18934147616----hao112233----李耀冲----410724200201081532\n" +
                    "18934148243----hao112233----冉进钎----532624200111240046\n" +
                    "18925437674----hao112233----刘艳玲----43312520011025432X\n" +
                    "18929214639----hao112233----龚颍航----411122199308158237\n" +
                    "18934149076----hao112233----江凡----522121200002222238\n" +
                    "18922939407----hao112233----江莉莉----310107199106275728\n" +
                    "18938194091----hao112233----张悦----231124200108031949\n" +
                    "18929167402----hao112233----于艳玲----130425200204295520\n" +
                    "18929417539----hao112233----闫振洋----412726199510030818\n" +
                    "18938216475----hao112233----李文龙----41142220001006183X\n" +
                    "18929134735----hao112233----于湧澎----412824199708163512\n" +
                    "18922535481----hao112233----赵明月----130423199608011426\n" +
                    "18926830084----hao112233----张浩----640221200112055718\n" +
                    "18925537420----hao112233----杨昌胜----530325199904140777\n" +
                    "18928204116----hao112233----王一罕----410182200012170334\n" +
                    "18925544091----hao112233----付立华----371526198712043722\n" +
                    "18938159664----hao112233----马影----412702200109034585\n" +
                    "18925799342----hao112233----丁凯----411625199901227113\n" +
                    "18928204717----hao112233----孙志蕊----130604199409071524\n" +
                    "18929104462----hao112233----冯海苹----110228198307293821\n" +
                    "18922904745----hao112233----任春飞----511623200201023001\n" +
                    "18929420354----hao112233----徐月----371425199603053625\n" +
                    "18922954926----hao112233----杨玉明----370502199910265214\n" +
                    "18938184641----hao112233----王铠----140311200110294066\n" +
                    "18922900374----hao112233----冉英杰----410402200002115571\n" +
                    "18929241615----hao112233----倪凯茵----37108320000514302X\n" +
                    "18922962449----hao112233----石相鹏----450322200106100013\n" +
                    "18925432437----hao112233----古馨茹----142333200208081421\n" +
                    "18938160445----hao112233----李博----142630199812271717\n" +
                    "18926861740----hao112233----刘晓宁----130532199301010025\n" +
                    "18938193486----hao112233----徐凯丽----371425200101070340\n" +
                    "18924341142----hao112233----李婷----431028200110022467\n" +
                    "18929180447----hao112233----郑云芳----410521199405086022\n" +
                    "18926864872----hao112233----叶秋闲----331022199311171285\n" +
                    "18925807143----hao112233----陈斌----612525198912281332\n" +
                    "18925401547----hao112233----杨成琼----532322199612060321\n" +
                    "18925791447----hao112233----郑宇杰----612727200009190817\n" +
                    "18128553269----hao112233----连兴珂----410102199812140160\n" +
                    "18128546963----hao112233----顿庆瑞----372930199609022693\n" +
                    "18128593329----hao112233----付丹蓉----510107199903181262\n" +
                    "18128575221----hao112233----董星星----410922199804156284\n" +
                    "18128576570----hao112233----许阳阳----41072719980305501X\n" +
                    "18925470281----hao112233----周宇璞----410184199403273813\n" +
                    "17368233340----hao112233----李斌----142427199603130310\n" +
                    "17368238450----hao112233----徐源源----37068319820210892X\n" +
                    "17329511243----hao112233----马洪云----132930198809073525\n" +
                    "17329510246----hao112233----宋媛媛----372928198608245629\n" +
                    "17329516640----hao112233----薛红英----372901198504164824\n" +
                    "17329509453----hao112233----杨明浦----411321200102123370\n" +
                    "17368236041----hao112233----龙飞婷----430224199909167789\n" +
                    "17329508417----hao112233----李红艳----370481198207160328\n" +
                    "17329513462----hao112233----魏钰霞----130726199009040722\n" +
                    "17329508427----hao112233----王亚茹----130531200102072345\n" +
                    "17368237564----hao112233----胡海珍----452628200201232424\n" +
                    "17368235437----hao112233----夏树全----370784199403123516\n" +
                    "17368240774----hao112233----高亚兰----321281199702254220\n" +
                    "18127148774----hao112233----段春云----532724200201280020\n" +
                    "17368238646----hao112233----褚新方----130427198201082725\n" +
                    "17329519314----hao112233----赵琼----53213019970514112X\n" +
                    "17329513403----hao112233----漫召召----622822199805200027\n" +
                    "17368239404----hao112233----纪殿福----211303200005173632\n" +
                    "17329511843----hao112233----吉锦红----370703200012070821\n" +
                    "17329512451----hao112233----程向前----142623198505023758\n" +
                    "17329511409----hao112233----妮夺朵----533323199004200623\n" +
                    "17329514479----hao112233----宋大玉----610624199806151560\n" +
                    "17329511045----hao112233----张天阳----230221200008274412\n" +
                    "17368239674----hao112233----武振兴----211382200003146011\n" +
                    "18126606476----hao112233----刘瑞丽----530302199709271582\n" +
                    "17368238740----hao112233----刘晶----330521197810260021\n" +
                    "17368236844----hao112233----万二娟----610481198912204242\n" +
                    "17329508934----hao112233----李慧敏----211321200002222446\n" +
                    "17368242240----hao112233----杜琳----211381200006221228\n" +
                    "18127132847----hao112233----解晓敏----142225200011240040\n" +
                    "17368239147----hao112233----鲁秀艳----211322197607207769\n" +
                    "17329517713----hao112233----陆正琴----53230120011130212X\n" +
                    "18241730915----222222\n" +
                    "18604075053----222222\n" +
                    "15840712103----222222\n" +
                    "13130598242----222222\n" +
                    "13941711138----222222\n" +
                    "13941707008----222222\n" +
                    "15902486358----222222\n" +
                    "13904077602----222222\n" +
                    "13840727371----222222\n" +
                    "18737164631----222222\n" +
                    "18539570435----222222\n" +
                    "15617863430----222222\n" +
                    "15638135784----222222\n" +
                    "15617863437----222222\n" +
                    "15637159452----222222\n" +
                    "15737180783----222222\n" +
                    "18838241210----222222\n" +
                    "13101715904----222222\n" +
                    "13137103749----222222\n" +
                    "15617620314----222222\n" +
                    "13937102176----222222\n" +
                    "15936290629----222222\n" +
                    "18538261453----222222\n" +
                    "18538070483----222222\n" +
                    "18537105483----222222\n" +
                    "18538764236----222222\n" +
                    "18143975450----222222\n" +
                    "18137112343----222222\n" +
                    "18972417517----222222\n" +
                    "15841602617----222222\n" +
                    "13941682898----222222\n" +
                    "15704242188----222222\n" +
                    "15724456606----222222\n" +
                    "15754161161----222222\n" +
                    "18741625419----222222\n" +
                    "18741608479----222222\n" +
                    "15216332501----222222\n" +
                    "15206337395----222222\n" +
                    "15314002726----222222\n" +
                    "15221864787----222222\n" +
                    "15021421682----222222\n" +
                    "13611908703----222222\n" +
                    "13127658451----222222\n" +
                    "13127646827----222222\n" +
                    "13262825490----222222\n" +
                    "13167081403----222222\n" +
                    "18936189433----222222\n" +
                    "18795711154----222222";

            for (String s1 : s.split("\n")) {
                accounts.add(new Account(s1.split("----")[0], s1.split("----")[1]));
            }

            for (Account account : accounts) {
               new Thread(new Runnable() {
                   @Override
                   public void run() {
                       try {

                           String sql = "INSERT INTO fx_order_account(phone,password) VALUES(?,?)";
                           // 获取PrepareStatement对象
                           PreparedStatement preparedStatement = conn.prepareStatement(sql);
                           // 填充占位符
                           preparedStatement.setString(1, account.getPhone());
                           preparedStatement.setString(2, account.getPassword());
                           // 执行sql
                           int num = preparedStatement.executeUpdate();// 返回影响到的行数

                           System.out.println("一共影响到" + num + "行");

                          /* Map<String, String> cookies = getCookies(account.getPhone(), account.getPassword());

                           Response execute = Jsoup.connect("https://mall.phicomm.com/my-receiver-save.html").method(org.jsoup.Connection.Method.POST).cookies(cookies)
                               .timeout(SystemConstant.TIME_OUT)
                               .ignoreContentType(true)
                               //.header("X-Requested-With", "XMLHttpRequest")
                               //.header("Content-Type", "application/x-www-form-urlencoded")
                               //.header("Upgrade-Insecure-Requests", "1")
                               .data("maddr[name]", "刘正周")
                               .data("maddr[mobile]", "13863749494")
                               .data("maddr[area]", "mainland:山东省/济宁市/微山县:1583")
                               .data("maddr[addr]", "山东省济宁市微山县苏园一村32号楼1单元888号-诗人")
                               .data("maddr[is_default]", "true")
                               .execute();
                           System.out.println(account.getPhone() + "---ok");*/


                       } catch (Exception e) {
                           e.printStackTrace();
                       }
                   }
               }).start();
                Thread.sleep(1000);
            }



            /*if (rs != null) {//11.关闭记录集
                try {
                    rs.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
            if (stmt != null) {//12.关闭声明的对象
                try {
                    stmt.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
            if (conn != null) {//13.关闭连接 （记住一定要先关闭前面的11.12.然后在关闭连接，就像关门一样，先关里面的，最后关最外面的）
                try {
                    conn.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }*/
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static Map<String, String> getCookies(String username, String password) throws Exception {
        try {
            Response pageResponse = Jsoup.connect("https://mall.phicomm.com/passport-login.html").method(org.jsoup.Connection.Method.GET).timeout(SystemConstant.TIME_OUT).execute();
            Map<String, String> pageCookies = pageResponse.cookies();

            Response loginResponse = Jsoup.connect("https://mall.phicomm.com/passport-post_login.html").method(org.jsoup.Connection.Method.POST)
                .cookies(pageCookies)
                .timeout(SystemConstant.TIME_OUT)
                .ignoreContentType(true)
                .header("X-Requested-With", "XMLHttpRequest")
                .data("forward", "")
                .data("uname", username)
                .data("password", password)
                .execute();


            if(loginResponse.body().contains("error")) {
                throw new RuntimeException("帐号或密码不正确");
            }

            Map<String, String> cks = new HashMap<>();
            cks.putAll(pageCookies);
            cks.putAll(loginResponse.cookies());
            return cks;
        }catch (Exception e){
            return getCookies(username, password);
        }
    }
}