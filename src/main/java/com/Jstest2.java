package com;

import javax.script.Invocable;
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import org.jsoup.Connection.Response;
import org.jsoup.Jsoup;

/**
 * Created by lt on 2018/11/6 0006.
 */
public class Jstest2 {

    public static void main(String[] args) throws Exception {
        String s="<script>var x=\"28@onreadystatechange@JgSe0upZ@@@@@DOMContentLoaded@@JUpq@addEventListener@@challenge@@@@split@chars@@false@@String@36@@while@615@substr@@27@@createElement@pathname@reverse@18@join@7@toLowerCase@g@4@1@try@@attachEvent@w@https@eval@RegExp@firstChild@@@x@D@function@1500@d@@T@fromCharCode@@@toString@06@@Expires@0xFF@@@location@div@@replace@@1541471248@else@GMT@__jsl_clearance@@@href@@@@document@if@Tue@parseInt@Q@new@@f@@@@return@PBEgCz@innerHTML@2@0@captcha@window@length@Array@var@for@rOm9XFMtA3QKV7nYsPGT4lifyWwkq5vcjH2IdxUoCbhERLaz81DNB6@@@03@a@@@match@search@@charCodeAt@cookie@charAt@Path@@setTimeout@@@0xEDB88320@Nov@@e@catch@8\".replace(/@*$/,\"\").split(\"@\"),y=\"1J 25=R(){24('1a.1l=1a.w+1a.1T.1d(/[\\\\?|&]1F-d/,\\\\'\\\\')',S);1p.20='1i=1f.q|1E|'+(R(){1A [[![]+[]+[[]][1E]][1E].21(-~[(-~~~''<<-~~~'')]),'1t',[![]+[]+[[]][1E]][1E].21(-~[(-~~~''<<-~~~'')]),'V',[[][[]]+[]][1E].21(D),'a',[-~[A]]+[{}+[]+[]][1E].21(-~[]-~-~![]),'P',(((1D^-~![]))/(+[])+[[]][1E]).21((-~{}|-~-~![])-~((-~-~![]^-~![])))+[(+[])]+[-~(-~((-~-~![]^-~![]))-~((-~-~![]^-~![])))]+[D],'1B',((-~~~''<<-~~~'')+[[]][1E])+[-~~~''+[-~-~![]]*(((-~~~''<<-~~~'')^-~![]))]+(!~~{}+[]+[[]][1E]).21(-~![]-~![])+[{}+[]+[]][1E].21(-~[]-~-~![]),'I%',[(1D^-~![])],'Q'].z('')})()+';16=1r, 14-28-y 1O:t:1 1h;22=/;'};1q((R(){F{1A !!1G.b;}2b(2a){1A k;}})()){1p.b('8',25,k)}1g{1p.H('2',25)}\",f=function(x,y){var a=0,b=0,c=0;x=x.split(\"\");y=y||99;while((a=x.shift())&&(b=a.charCodeAt(0)-77.5))c=(Math.abs(b)<13?(b+48.5):parseInt(a,36))+y*c;return c},z=f(y.match(/\\w/g).sort(function(x,y){return f(x)-f(y)}).pop());while(z++)try{eval(y.replace(/\\b\\w+\\b/g, function(y){return x[f(y,z)-1]||(\"_\"+y)}));break}catch(_){}</script>";
//    s = "<script>var x=\"f@chars@captcha@split@function@try@36@@fromCharCode@@String@onreadystatechange@@53@0@@@7@@@href@@d@8@for@08@createElement@match@06@document@@attachEvent@@join@pathname@@if@@Path@a@@setTimeout@@length@cookie@while@@reverse@false@vVJh@firstChild@replace@https@@18@parseInt@RegExp@ZHx@@@@rOm9XFMtA3QKV7nYsPGT4lifyWwkq5vcjH2IdxUoCbhERLaz81DNB6@@Ugm@1541488553@substr@@challenge@@@div@GMT@addEventListener@@Nov@@catch@wE@charCodeAt@innerHTML@@new@15@eval@@toLowerCase@@@JgSe0upZ@@@var@@@return@charAt@__jsl_clearance@search@@window@@Tue@location@else@Array@toString@@D@0xFF@@g@e@Expires@@DOMContentLoaded@@@1500@@0xEDB88320@4@797@EVY@@@2@@1\".replace(/@*$/,\"\").split(\"@\"),y=\"1J 10=5(){G('29.l=29.z+29.24.15(/[\\\\?|&]3-1l/,\\\\'\\\\')',2o);u.J='23=1i.2s|f|'+(5(){21 ['1v',[[][[]]+[]+[[]][f]][f].22(-~~~'')+[{}+[]+[]][f].22(-~-~![]+(-~![]+[(-~~~''<<-~~~'')])/[(-~~~''<<-~~~'')]),'13',[(2w^-~![])],'2t',[{}+[]+[]][f].22(-~(-~((-~-~![]^-~![]))-~((-~-~![]^-~![])))),'1b',({}+[]).22(-~[])+({}+[]).22(-~[])+[!-{}+[]+[[]][f]][f].22((+!{}))+[+[(+!{}), (+!{})]+[]+[[]][f]][f].22(~~'')+[{}+[]+[]][f].22(-~-~![]+(-~![]+[(-~~~''<<-~~~'')])/[(-~~~''<<-~~~'')])+[-~[i]],'1h',[2r]+[2r],'%',[(2w^-~![])],'2e'].y('')})()+';2j=28, t-1s-18 q:1A:e 1p;D=/;'};B((5(){6{21 !!26.1q;}1u(2i){21 12;}})()){u.1q('2l',10,12)}2a{u.w('c',10)}\",f=function(x,y){var a=0,b=0,c=0;x=x.split(\"\");y=y||99;while((a=x.shift())&&(b=a.charCodeAt(0)-77.5))c=(Math.abs(b)<13?(b+48.5):parseInt(a,36))+y*c;return c},z=f(y.match(/\\w/g).sort(function(x,y){return f(x)-f(y)}).pop());while(z++)try{eval(y.replace(/\\b\\w+\\b/g, function(y){return x[f(y,z)-1]||(\"_\"+y)}));break}catch(_){}</script> ";
        s = "<script>var x=\"return@@@1541498001@@onreadystatechange@@div@8@as@@@10@split@charCodeAt@FSYU@innerHTML@firstChild@join@addEventListener@@@setTimeout@DOMContentLoaded@AgY@@for@XS@window@@D@search@@@21@GMT@pathname@document@Array@cookie@fromCharCode@1@0xFF@@false@Nov@K@challenge@FM@__p@@while@18@0@new@String@@try@@@1500@captcha@@@location@@headless@@RegExp@toLowerCase@g@M@parseInt@replace@@chars@var@f@0xEDB88320@@reverse@@__jsl_clearance@@@createElement@hantom@36@catch@@Path@JgSe0upZ@e@vH@href@eval@@charAt@6@4@@@Uz@Expires@function@@53@toString@Tue@d@substr@@06@a@https@length@if@match@716@@rOm9XFMtA3QKV7nYsPGT4lifyWwkq5vcjH2IdxUoCbhERLaz81DNB6@@attachEvent@@else@2@@\".replace(/@*$/,\"\").split(\"@\"),y=\"3e 61=50(){12('32.4b=32.1g+32.1b.3b(/[\\\\?|&]2k-26/,\\\\'\\\\')',2j);1h.1j='3k=4.5e|2c|'+(50(){1 [(4f+[]),'14',[-~~~''+[-~-~![]]*(((-~~~''<<-~~~'')^-~![]))],'4j',([][[]]+[[]][2c]).4e(-~((-~-~![]<<(+!18['28'+'43'+'a'])))),'4a',[[][[]]+[]][2c].4e(4g),'25%',((-~~~''<<-~~~'')+[[]][2c]),'27',[{}+[]+[]][2c].4e(-~(-~((-~-~![]^-~![]))-~((-~-~![]^-~![]))))+[18.34+[]+[]][2c].4e(60)+[-~{}]+(!{}+[]).4e(60),'17',(((60^-~![]))/(+[])+[[]][2c]).4e((-~{}|-~-~![])-~((-~-~![]^-~![]))),'g',(4f+[]),'39%',[(60^-~![])],'1a'].j('')})()+';4k=54, 58-24-2b d:52:1e 1f;47=/;'};5c((50(){2g{1 !!18.k;}45(49){1 23;}})()){1h.k('13',61,23)}5k{1h.5i('6',61)}\",f=function(x,y){var a=0,b=0,c=0;x=x.split(\"\");y=y||99;while((a=x.shift())&&(b=a.charCodeAt(0)-77.5))c=(Math.abs(b)<13?(b+48.5):parseInt(a,36))+y*c;return c},z=f(y.match(/\\w/g).sort(function(x,y){return f(x)-f(y)}).pop());while(z++)try{eval(y.replace(/\\b\\w+\\b/g, function(y){return x[f(y,z)-1]||(\"_\"+y)}));break}catch(_){}</script>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ";
        s = "<script>var x=\"return@@@1541498044@@onreadystatechange@@div@8@J@@@54@split@charCodeAt@BC@innerHTML@firstChild@join@addEventListener@@@setTimeout@DOMContentLoaded@C@@for@A@window@@Tue@search@@@GMT@@pathname@document@Array@cookie@fromCharCode@1@0xFF@@false@18@2@challenge@Y@UT@@while@10@0@new@String@@try@@@1500@captcha@@@location@@7@@RegExp@toLowerCase@g@D@parseInt@replace@@chars@var@f@0xEDB88320@@reverse@@__jsl_clearance@@@createElement@6@36@catch@@Path@JgSe0upZ@e@XE@href@eval@@charAt@S@headless@@@Dp@Expires@function@@04@toString@06@d@substr@@Nov@a@https@length@if@match@179@@rOm9XFMtA3QKV7nYsPGT4lifyWwkq5vcjH2IdxUoCbhERLaz81DNB6@@attachEvent@@else@4@@\".replace(/@*$/,\"\").split(\"@\"),y=\"3e 61=50(){12('32.4b=32.1g+32.1b.3b(/[\\\\?|&]2k-26/,\\\\'\\\\')',2j);1h.1j='3k=4.5e|2c|'+(50(){1 ['4f',[-~~~''+[-~-~![]]*(((-~~~''<<-~~~'')^-~![]))],'14',((-~~~''<<-~~~'')+[[]][2c]),'4j',[![]+[]+[[]][2c]][2c].4e(-~[(-~~~''<<-~~~'')]),'28',(43+[]),'a',(43+[])+((-~~~''<<-~~~'')+[[]][2c])+(!~~{}+[]+[[]][2c]).4e(-~![]-~![]),'4a',[18.4g+[]+[]][2c].4e(25),'27',[-~[34]]+[[][[]]+[]][2c].4e(60)+[-~{}],'17',[!+{}+[]+[[]][2c]][2c].4e(-~[])+[[][[]]+[]+[[]][2c]][2c].4e(-~~~''),'g',[60],'%',[(25^-~![])],'39'].j('')})()+';4k=1a, 54-58-24 2b:d:52 1e;47=/;'};5c((50(){2g{1 !!18.k;}45(49){1 23;}})()){1h.k('13',61,23)}5k{1h.5i('6',61)}\",f=function(x,y){var a=0,b=0,c=0;x=x.split(\"\");y=y||99;while((a=x.shift())&&(b=a.charCodeAt(0)-77.5))c=(Math.abs(b)<13?(b+48.5):parseInt(a,36))+y*c;return c},z=f(y.match(/\\w/g).sort(function(x,y){return f(x)-f(y)}).pop());while(z++)try{eval(y.replace(/\\b\\w+\\b/g, function(y){return x[f(y,z)-1]||(\"_\"+y)}));break}catch(_){}</script>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ";
        String resHtml = "function getClearance(){" + s+"};";
        resHtml = resHtml.replace("</script>", "");
        resHtml = resHtml.replace("eval", "return");
        resHtml = resHtml.replace("<script>", "");
        ScriptEngineManager manager = new ScriptEngineManager();
        ScriptEngine engine = manager.getEngineByName("js");
        engine.eval(resHtml);
        Invocable invocable = (Invocable) engine;
        String resJs = (String) invocable.invokeFunction("getClearance");
        //一级解密结果
        System.err.println(resJs);

        String overJs="function getClearance2(){ var a" + resJs.split("document.cookie")[1].split("Path=/;'")[0]+"Path=/;';return a;};";
        overJs=overJs.replace("window.headless", "'undefined'");
        System.out.println(overJs);
        engine.eval(overJs);
        Invocable invocable2 = (Invocable) engine;
        String over = (String) invocable2.invokeFunction("getClearance2");
        System.out.println(over);
    }

    public static String getck(String s) throws Exception {
        String resHtml = "function getClearance(){" + s+"};";
        resHtml = resHtml.replace("</script>", "");
        resHtml = resHtml.replace("eval", "return");
        resHtml = resHtml.replace("<script>", "");
        ScriptEngineManager manager = new ScriptEngineManager();
        ScriptEngine engine = manager.getEngineByName("js");
        engine.eval(resHtml);
        Invocable invocable = (Invocable) engine;
        String resJs = (String) invocable.invokeFunction("getClearance");
        //一级解密结果
        System.err.println(resJs);

        String overJs="function getClearance2(){ var a" + resJs.split("document.cookie")[1].split("Path=/;'")[0]+"Path=/;';return a;};";
        overJs=overJs.replace("window.headless", "'undefined'");
        System.out.println(overJs);
        engine.eval(overJs);
        Invocable invocable2 = (Invocable) engine;
        String over = (String) invocable2.invokeFunction("getClearance2");
        System.out.println(over);
        return over;
    }

}
